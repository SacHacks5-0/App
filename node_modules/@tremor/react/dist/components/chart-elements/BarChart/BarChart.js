'use client';
import{__rest as t}from"tslib";import{BaseColors as e}from"../../../lib/constants.js";import{themeColorRange as a,colorPalette as l}from"../../../lib/theme.js";import{tremorTwMerge as o}from"../../../lib/tremorTwMerge.js";import{getColorClassNames as i,defaultValueFormatter as r}from"../../../lib/utils.js";import n,{useState as s}from"react";import{ResponsiveContainer as c,BarChart as m,CartesianGrid as d,XAxis as u,YAxis as v,Tooltip as p,Legend as h,Bar as y}from"recharts";import f from"../common/ChartLegend.js";import k from"../common/ChartTooltip.js";import g from"../common/NoData.js";import{constructCategoryColors as b,deepEqual as w,getYAxisDomain as x}from"../common/utils.js";const E=n.forwardRef(((E,j)=>{const{data:O=[],categories:T=[],index:A,colors:L=a,valueFormatter:C=r,layout:N="horizontal",stack:D=!1,relative:V=!1,startEndOnly:F=!1,animationDuration:K=900,showAnimation:S=!1,showXAxis:G=!0,showYAxis:M=!0,yAxisWidth:z=56,intervalType:P="equidistantPreserveStart",showTooltip:B=!0,showLegend:W=!0,showGridLines:X=!0,autoMinValue:Y=!1,minValue:q,maxValue:I,allowDecimals:R=!0,noDataText:$,onValueChange:H,customTooltip:J,className:Q}=E,U=t(E,["data","categories","index","colors","valueFormatter","layout","stack","relative","startEndOnly","animationDuration","showAnimation","showXAxis","showYAxis","yAxisWidth","intervalType","showTooltip","showLegend","showGridLines","autoMinValue","minValue","maxValue","allowDecimals","noDataText","onValueChange","customTooltip","className"]),Z=J,[_,tt]=s(60),et=b(T,L),[at,lt]=n.useState(void 0),[ot,it]=s(void 0),rt=!!H;function nt(t,e,a){var l,o,i,r;a.stopPropagation(),H&&(w(at,Object.assign(Object.assign({},t.payload),{value:t.value}))?(it(void 0),lt(void 0),null==H||H(null)):(it(null===(o=null===(l=t.tooltipPayload)||void 0===l?void 0:l[0])||void 0===o?void 0:o.dataKey),lt(Object.assign(Object.assign({},t.payload),{value:t.value})),null==H||H(Object.assign({eventType:"bar",categoryClicked:null===(r=null===(i=t.tooltipPayload)||void 0===i?void 0:i[0])||void 0===r?void 0:r.dataKey},t.payload))))}const st=x(Y,q,I);return n.createElement("div",Object.assign({ref:j,className:o("w-full h-80",Q)},U),n.createElement(c,{className:"h-full w-full"},(null==O?void 0:O.length)?n.createElement(m,{data:O,stackOffset:D?"sign":V?"expand":"none",layout:"vertical"===N?"vertical":"horizontal",onClick:rt&&(ot||at)?()=>{lt(void 0),it(void 0),null==H||H(null)}:void 0},X?n.createElement(d,{className:o("stroke-1","stroke-tremor-border","dark:stroke-dark-tremor-border"),horizontal:"vertical"!==N,vertical:"vertical"===N}):null,"vertical"!==N?n.createElement(u,{padding:{left:20,right:20},hide:!G,dataKey:A,interval:F?"preserveStartEnd":P,tick:{transform:"translate(0, 6)"},ticks:F?[O[0][A],O[O.length-1][A]]:void 0,fill:"",stroke:"",className:o("mt-4 text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content"),tickLine:!1,axisLine:!1}):n.createElement(u,{hide:!G,type:"number",tick:{transform:"translate(-3, 0)"},domain:st,fill:"",stroke:"",className:o("text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content"),tickLine:!1,axisLine:!1,tickFormatter:C,minTickGap:5,allowDecimals:R}),"vertical"!==N?n.createElement(v,{width:z,hide:!M,axisLine:!1,tickLine:!1,type:"number",domain:st,tick:{transform:"translate(-3, 0)"},fill:"",stroke:"",className:o("text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content"),tickFormatter:V?t=>`${(100*t).toString()} %`:C,allowDecimals:R}):n.createElement(v,{width:z,hide:!M,dataKey:A,axisLine:!1,tickLine:!1,ticks:F?[O[0][A],O[O.length-1][A]]:void 0,type:"category",interval:"preserveStartEnd",tick:{transform:"translate(0, 6)"},fill:"",stroke:"",className:o("text-tremor-label","fill-tremor-content","dark:fill-dark-tremor-content")}),n.createElement(p,{wrapperStyle:{outline:"none"},isAnimationActive:!1,cursor:{fill:"#d1d5db",opacity:"0.15"},content:B?({active:t,payload:a,label:l})=>Z?n.createElement(Z,{payload:null==a?void 0:a.map((t=>{var a;return Object.assign(Object.assign({},t),{color:null!==(a=et.get(t.dataKey))&&void 0!==a?a:e.Gray})})),active:t,label:l}):n.createElement(k,{active:t,payload:a,label:l,valueFormatter:C,categoryColors:et}):n.createElement(n.Fragment,null),position:{y:0}}),W?n.createElement(h,{verticalAlign:"top",height:_,content:({payload:t})=>f({payload:t},et,tt,ot,rt?t=>{return e=t,void(rt&&(e!==ot||at?(it(e),null==H||H({eventType:"category",categoryClicked:e})):(it(void 0),null==H||H(null)),lt(void 0)));var e}:void 0)}):null,T.map((t=>{var a;return n.createElement(y,{className:o(i(null!==(a=et.get(t))&&void 0!==a?a:e.Gray,l.background).fillColor,H?"cursor-pointer":""),key:t,name:t,type:"linear",stackId:D||V?"a":void 0,dataKey:t,fill:"",isAnimationActive:S,animationDuration:K,shape:t=>((t,e,a,l)=>{const{fillOpacity:o,name:i,payload:r,value:s}=t;let{x:c,width:m,y:d,height:u}=t;return"horizontal"===l&&u<0?(d+=u,u=Math.abs(u)):"vertical"===l&&m<0&&(c+=m,m=Math.abs(m)),n.createElement("rect",{x:c,y:d,width:m,height:u,opacity:e||a&&a!==i?w(e,Object.assign(Object.assign({},r),{value:s}))?o:.3:o})})(t,at,ot,N),onClick:nt})}))):n.createElement(g,{noDataText:$})))}));E.displayName="BarChart";export{E as default};
